<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile / Nexus</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #000; --accent: #1D9BF0; --border: #2F3336; --text-dim: #71767B; }
        body { background: var(--bg); color: white; font-family: 'Plus Jakarta Sans', sans-serif; margin: 0; display: flex; justify-content: center; }
        
        .profile-wrapper { width: 600px; border-left: 1px solid var(--border); border-right: 1px solid var(--border); min-height: 100vh; position: relative; }
        
        /* Banner & PFP Header */
        .banner { height: 200px; background: #333; transition: 0.3s; }
        .pfp-container { position: relative; height: 75px; padding: 0 16px; display: flex; justify-content: space-between; align-items: flex-end; }
        .pfp-overlap { width: 140px; height: 140px; border-radius: 50%; border: 4px solid #000; background: #111; position: absolute; top: -70px; object-fit: cover; }
        
        /* Profile Info */
        .info-section { padding: 16px; margin-top: 10px; }
        .display-name { font-size: 1.5rem; font-weight: 800; margin: 0; }
        .handle { color: var(--text-dim); font-size: 1rem; margin-bottom: 12px; }
        .bio { font-size: 1rem; line-height: 1.4; margin-bottom: 12px; min-height: 20px; }
        
        .meta-data { display: flex; gap: 15px; color: var(--text-dim); font-size: 0.9rem; margin-bottom: 12px; }
        .stats { display: flex; gap: 20px; font-size: 0.9rem; }
        .stats b { color: white; }
        .stats span { color: var(--text-dim); }

        /* Tabs */
        .tabs { display: flex; border-bottom: 1px solid var(--border); margin-top: 20px; }
        .tab { flex: 1; text-align: center; padding: 15px 0; cursor: pointer; color: var(--text-dim); font-weight: 600; }
        .tab.active { color: white; border-bottom: 4px solid var(--accent); }

        /* Buttons */
        .btn-action { background: white; color: black; border: none; padding: 10px 20px; border-radius: 50px; font-weight: 800; cursor: pointer; margin-bottom: 10px; }
        .btn-outline { background: transparent; border: 1px solid var(--border); color: white; padding: 10px 20px; border-radius: 50px; font-weight: 800; cursor: pointer; margin-bottom: 10px; }

        /* Edit Modal */
        #edit-modal { display: none; position: fixed; inset: 0; background: rgba(91, 112, 131, 0.4); z-index: 1000; align-items: center; justify-content: center; backdrop-filter: blur(2px); }
        .modal-content { background: #000; border-radius: 16px; width: 400px; padding: 20px; border: 1px solid var(--border); }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; color: var(--text-dim); font-size: 0.8rem; margin-bottom: 5px; }
        .input-group input, .input-group textarea { width: 100%; background: transparent; border: 1px solid var(--border); border-radius: 4px; color: white; padding: 10px; box-sizing: border-box; }
    </style>
</head>
<body>

    <div class="profile-wrapper">
        <div id="banner-bg" class="banner"></div>
        
        <div class="pfp-container">
            <img id="pfp" class="pfp-overlap" src="https://tr.rbxcdn.com/30DAY-AvatarHeadshot-Png-720-720-True/420/420/AvatarHeadshot/Png/Circular">
            <div style="flex:1"></div>
            <div id="action-area">
                <button class="btn-action">Follow</button>
            </div>
        </div>

        <div class="info-section">
            <h1 id="view-name" class="display-name">Loading...</h1>
            <div id="view-handle" class="handle">@fetching</div>
            
            <div id="view-bio" class="bio">Nexus Developer üõ†Ô∏è</div>
            
            <div class="meta-data">
                <span>üìç Roblox Studio</span>
                <span>üìÖ Joined Feb 2026</span>
            </div>

            <div class="stats">
                <span><b>0</b> Following</span>
                <span><b>0</b> Followers</span>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active">Posts</div>
            <div class="tab">Replies</div>
            <div class="tab">Media</div>
            <div class="tab">Likes</div>
        </div>

        <div id="posts-feed" style="padding: 40px; text-align: center; color: var(--text-dim);">
            No posts found for this user.
        </div>
    </div>

    <div id="edit-modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <h2 style="margin:0;">Edit profile</h2>
                <button onclick="saveProfile()" class="btn-action">Save</button>
            </div>
            
            <div class="input-group">
                <label>Banner Color</label>
                <input type="color" id="edit-color" style="height:50px;">
            </div>

            <div class="input-group">
                <label>Bio</label>
                <textarea id="edit-bio" rows="3"></textarea>
            </div>
            <button onclick="closeEdit()" class="btn-outline" style="width:100%;">Cancel</button>
        </div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const targetUser = params.get('user');
        const myUser = localStorage.getItem('rbx_user');

        window.onload = async () => {
            if (!targetUser) return;

            // Setup UI for current user
            document.getElementById('view-name').innerText = targetUser;
            document.getElementById('view-handle').innerText = `@${targetUser.toLowerCase()}`;

            // Check if viewing own profile
            if (targetUser === myUser) {
                document.getElementById('action-area').innerHTML = `
                    <button class="btn-outline" onclick="openEdit()">Edit Profile</button>
                `;
            }

            // Load saved Bio/Banner from localStorage
            const savedBio = localStorage.getItem(`bio_${targetUser}`);
            const savedColor = localStorage.getItem(`color_${targetUser}`);
            if(savedBio) document.getElementById('view-bio').innerText = savedBio;
            if(savedColor) document.getElementById('banner-bg').style.background = savedColor;

            // Fetch Roblox Data
            try {
                const search = await fetch(`https://users.roproxy.com/v1/users/search?keyword=${targetUser}&limit=1`);
                const sData = await search.json();
                if(sData.data && sData.data[0]) {
                    const thumb = await fetch(`https://thumbnails.roproxy.com/v1/users/avatar-headshot?userIds=${sData.data[0].id}&size=150x150&format=Png&isCircular=true`);
                    const tData = await thumb.json();
                    document.getElementById('pfp').src = tData.data[0].imageUrl;
                }
            } catch(e) { console.warn("Roblox fetch failed, using placeholder"); }
        };

        function openEdit() {
            document.getElementById('edit-modal').style.display = 'flex';
            document.getElementById('edit-bio').value = document.getElementById('view-bio').innerText;
        }

        function closeEdit() {
            document.getElementById('edit-modal').style.display = 'none';
        }

        function saveProfile() {
            const bioVal = document.getElementById('edit-bio').value;
            const colorVal = document.getElementById('edit-color').value;

            // Save locally
            localStorage.setItem(`bio_${targetUser}`, bioVal);
            localStorage.setItem(`color_${targetUser}`, colorVal);

            // Update UI
            document.getElementById('view-bio').innerText = bioVal;
            document.getElementById('banner-bg').style.background = colorVal;
            
            closeEdit();
        }
    </script>
</body>
</html>
